<!DOCTYPE html>
<html lang="sv">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sten Sax Påse</title>

<style>
    body {
        margin: 0;
        background: black;
        overflow: hidden;
    }

    #game-container {
        width: 100vw;
        height: 100vh;
        background: black;
    }

    /* Flyttad till höger nedre hörn */
    .back {
        position: fixed;
        bottom: 20px;
        right: 20px;
        background: rgba(0,0,0,0.5);
        padding: 10px 16px;
        border-radius: 8px;
        color: white;
        text-decoration: none;
        border: 2px solid #666;
        z-index: 9999;
        font-size: 18px;
        cursor: pointer;
    }

    .back:hover {
        background: rgba(40,40,40,0.6);
    }
</style>
</head>
<body>

<!-- Stäng-knapp som stänger fliken -->
<button class="back" onclick="window.close()">✖ Stäng</button>

<div id="game-container">
    <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rock Paper Scissors - Online Battle</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- FontAwesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Supabase Client -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Roboto:wght@400;700&display=swap');
        
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #0f172a;
            color: #f8fafc;
            margin: 0;
            padding: 0;
        }
        
        h1, h2, .retro-text {
            font-family: 'Press Start 2P', cursive;
        }

        .btn-retro {
            background-color: #e94560;
            color: #fff;
            border-bottom: 4px solid #b52b41;
            transition: all 0.1s;
        }
        .btn-retro:active {
            transform: translateY(2px);
            border-bottom: 2px solid #b52b41;
        }
        
        .choice-btn {
            transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .choice-btn:hover {
            transform: scale(1.15);
            background-color: #1e293b;
            border-color: #e94560;
        }

        /* Battle animations */
        @keyframes punch-left {
            0% { transform: translateX(0) rotate(0deg); }
            50% { transform: translateX(30px) rotate(10deg); }
            100% { transform: translateX(0) rotate(0deg); }
        }
        @keyframes punch-right {
            0% { transform: translateX(0) rotate(0deg); }
            50% { transform: translateX(-30px) rotate(-10deg); }
            100% { transform: translateX(0) rotate(0deg); }
        }
        .punching-left { animation: punch-left 0.4s ease-in-out; }
        .punching-right { animation: punch-right 0.4s ease-in-out; }
        
        .hidden { display: none !important; }

        /* Full-screen centering container */
        .game-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1.5rem;
        }
    </style>
</head>
<body class="bg-slate-950 overflow-hidden select-none">

    <!-- SETUP WARNING -->
    <div id="setup-warning" class="absolute top-0 w-full bg-red-600 text-white p-2 text-center text-xs font-bold hidden z-50">
        Message from developer: Do not expose any personal information online. Stay safe!
    </div>

    <div class="game-container">
        
        <!-- MAIN MENU -->
        <div id="menu-screen" class="w-full max-w-md p-8 text-center space-y-10 animate-fade-in">
            <div class="space-y-4">
                <h1 class="text-3xl md:text-4xl text-yellow-400 leading-tight tracking-tighter">ROCK PAPER<br>SCISSORS<br>BATTLE</h1>
                <p class="text-slate-400 text-xs tracking-widest uppercase">The Ultimate Online Arena</p>
            </div>
            
            <div class="space-y-4">
                <button onclick="startGameAI()" class="btn-retro w-full py-5 rounded-lg text-lg font-bold shadow-xl flex items-center justify-center gap-3">
                    <i class="fas fa-robot"></i> VS COMPUTER
                </button>
                <button onclick="showNameEntry()" class="btn-retro w-full py-5 rounded-lg text-lg font-bold shadow-xl bg-blue-600 border-blue-800 flex items-center justify-center gap-3">
                    <i class="fas fa-globe"></i> ONLINE BATTLE
                </button>
                <button onclick="showLeaderboard()" class="btn-retro w-full py-5 rounded-lg text-lg font-bold shadow-xl bg-emerald-600 border-emerald-800 flex items-center justify-center gap-3">
                    <i class="fas fa-trophy"></i> LEADERBOARD
                </button>
            </div>
        </div>

        <!-- NAME ENTRY -->
        <div id="name-screen" class="hidden w-full max-w-md p-8 text-center space-y-8">
            <h2 class="text-xl text-blue-400 uppercase tracking-widest">Identify Yourself</h2>
            <input type="text" id="player-name-input" maxlength="12" placeholder="Enter username..." class="w-full p-4 rounded-lg bg-slate-900 text-white border-2 border-slate-700 text-center text-xl outline-none focus:border-yellow-400 transition-colors">
            <div class="flex gap-4">
                <button onclick="showMenu()" class="flex-1 py-4 rounded-lg bg-slate-800 hover:bg-slate-700 font-bold">BACK</button>
                <button onclick="enterLobbySystem()" class="flex-1 btn-retro py-4 rounded-lg bg-blue-600 border-blue-800 font-bold text-lg">ENTER</button>
            </div>
        </div>

        <!-- LOBBY BROWSER -->
        <div id="lobby-screen" class="hidden w-full max-w-xl p-6 flex flex-col h-[85vh]">
            <div class="flex justify-between items-center mb-8">
                <h2 class="text-xl text-yellow-400 uppercase">Live Lobbies</h2>
                <button onclick="showMenu()" class="text-xs bg-slate-800 px-4 py-2 rounded-full border border-slate-600 hover:bg-slate-700">EXIT</button>
            </div>

            <div class="grid grid-cols-2 gap-3 mb-6">
                <button onclick="refreshLobbies()" class="bg-slate-800 p-4 rounded-lg hover:bg-slate-700 flex items-center justify-center gap-2"><i class="fas fa-sync"></i> REFRESH</button>
                <button onclick="createLobby()" class="btn-retro bg-emerald-600 border-emerald-800 p-4 rounded-lg flex items-center justify-center gap-2 font-bold"><i class="fas fa-plus"></i> NEW ROOM</button>
            </div>

            <div id="lobby-list" class="flex-1 overflow-y-auto bg-slate-900/50 rounded-xl p-4 space-y-3 border border-slate-800">
                <p class="text-slate-500 text-center mt-10 italic">Scanning for players...</p>
            </div>
        </div>

        <!-- WAITING SCREEN -->
        <div id="waiting-screen" class="hidden w-full max-w-md p-8 text-center space-y-6">
            <div class="relative">
                <div class="w-20 h-20 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto"></div>
                <div class="absolute inset-0 flex items-center justify-center">
                    <i class="fas fa-wifi text-blue-500"></i>
                </div>
            </div>
            <h2 class="text-xl font-bold uppercase tracking-widest">Waiting for Rival...</h2>
            <div class="bg-slate-900 p-3 rounded-lg border border-slate-800">
                <p id="lobby-code-display" class="text-yellow-500 text-sm font-mono"></p>
            </div>
            <button onclick="leaveLobby()" class="px-8 py-3 bg-red-600 rounded-lg hover:bg-red-500 font-bold">CANCEL</button>
        </div>

        <!-- COUNTDOWN -->
        <div id="countdown-screen" class="hidden absolute inset-0 bg-slate-950/95 z-50 flex flex-col items-center justify-center space-y-4">
            <p class="text-slate-400 uppercase tracking-[0.5em] text-sm">Match Starting</p>
            <h1 id="countdown-number" class="text-9xl text-yellow-400 font-bold animate-ping">5</h1>
        </div>

        <!-- GAME UI -->
        <div id="game-screen" class="hidden w-full max-w-4xl p-4 flex flex-col justify-between h-[90vh] mx-auto">
            <!-- Scoreboard -->
            <div class="grid grid-cols-3 items-center pb-6 border-b border-slate-800">
                <div class="text-center">
                    <p id="p1-name" class="text-xs text-blue-400 font-bold uppercase mb-1">PLAYER</p>
                    <p id="p1-score" class="text-5xl font-black text-white">0</p>
                </div>
                <div class="text-center">
                    <div class="px-4 py-1 bg-slate-800 rounded-full text-[10px] text-slate-400 inline-block font-bold">VS</div>
                </div>
                <div class="text-center">
                    <p id="p2-name" class="text-xs text-red-400 font-bold uppercase mb-1">OPPONENT</p>
                    <p id="p2-score" class="text-5xl font-black text-white">0</p>
                </div>
            </div>

            <!-- Battle Arena -->
            <div class="flex-1 flex flex-col items-center justify-center relative my-10">
                <div id="result-message" class="absolute -top-10 px-6 py-2 rounded-full text-xl font-bold bg-slate-900 border border-slate-700 hidden">DRAW!</div>
                
                <div class="flex w-full justify-around items-center">
                    <!-- My Side -->
                    <div class="flex flex-col items-center gap-4">
                        <div id="my-move-display" class="w-32 h-32 md:w-48 md:h-48 rounded-full bg-slate-900/50 border-4 border-blue-500/30 flex items-center justify-center text-6xl md:text-8xl text-blue-500 transition-all shadow-[0_0_50px_rgba(59,130,246,0.1)]">
                            <i class="fas fa-fist-raised"></i>
                        </div>
                    </div>

                    <!-- Opponent Side -->
                    <div class="flex flex-col items-center gap-4">
                        <div id="op-move-display" class="w-32 h-32 md:w-48 md:h-48 rounded-full bg-slate-900/50 border-4 border-red-500/30 flex items-center justify-center text-6xl md:text-8xl text-red-500 transition-all shadow-[0_0_50px_rgba(239,68,68,0.1)]">
                            <i class="fas fa-fist-raised"></i>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div id="controls-area" class="bg-slate-900/80 p-6 rounded-3xl border border-slate-800 backdrop-blur-sm">
                <p id="instruction-text" class="text-center mb-6 text-slate-400 text-xs font-bold uppercase tracking-widest">Choose Your Move</p>
                <div class="flex justify-center gap-6">
                    <button onclick="makeMove('sten')" class="choice-btn w-20 h-20 md:w-24 md:h-24 rounded-2xl bg-slate-800 border-b-4 border-slate-600 flex flex-col items-center justify-center gap-2 text-2xl shadow-xl">
                        <i class="fas fa-hand-rock"></i>
                        <span class="text-[10px] font-bold uppercase">Rock</span>
                    </button>
                    <button onclick="makeMove('pase')" class="choice-btn w-20 h-20 md:w-24 md:h-24 rounded-2xl bg-slate-800 border-b-4 border-slate-600 flex flex-col items-center justify-center gap-2 text-2xl shadow-xl">
                        <i class="fas fa-hand-paper"></i>
                        <span class="text-[10px] font-bold uppercase">Paper</span>
                    </button>
                    <button onclick="makeMove('sax')" class="choice-btn w-20 h-20 md:w-24 md:h-24 rounded-2xl bg-slate-800 border-b-4 border-slate-600 flex flex-col items-center justify-center gap-2 text-2xl shadow-xl">
                        <i class="fas fa-hand-scissors"></i>
                        <span class="text-[10px] font-bold uppercase">Scissor</span>
                    </button>
                </div>
                <p id="status-text" class="text-center mt-6 text-yellow-500 text-sm font-bold min-h-[20px] italic"></p>
            </div>
        </div>

        <!-- WINNER SCREEN -->
        <div id="winner-screen" class="hidden absolute inset-0 bg-slate-950/98 z-[60] flex flex-col items-center justify-center space-y-10">
            <div class="text-center space-y-2">
                <h1 id="end-title" class="text-5xl md:text-6xl text-yellow-400 retro-text text-center px-4">VICTORY!</h1>
                <p id="end-reason" class="text-slate-400 uppercase tracking-widest">Champion of the Arena</p>
            </div>
            <button onclick="showMenu()" class="btn-retro px-12 py-5 rounded-xl text-xl font-black shadow-2xl">RETURN TO HUB</button>
        </div>

        <!-- LEADERBOARD -->
        <div id="leaderboard-screen" class="hidden w-full max-w-xl p-8 h-[85vh] flex flex-col space-y-6">
            <h2 class="text-xl text-yellow-400 text-center mb-4 retro-text uppercase">HOF: Top 10</h2>
            <div class="bg-slate-900/80 rounded-2xl flex-1 overflow-y-auto border border-slate-800 p-2">
                <table class="w-full text-left border-separate border-spacing-y-2">
                    <thead class="sticky top-0 bg-slate-900 z-10">
                        <tr class="text-slate-500 text-[10px] font-bold uppercase">
                            <th class="px-4 py-2">Rank</th>
                            <th class="px-4 py-2">Warrior</th>
                            <th class="px-4 py-2 text-right">Victories</th>
                        </tr>
                    </thead>
                    <tbody id="leaderboard-body">
                        <!-- Filled by JS -->
                    </tbody>
                </table>
            </div>
            <button onclick="showMenu()" class="py-4 bg-slate-800 rounded-xl w-full hover:bg-slate-700 font-bold border border-slate-700">CLOSE</button>
        </div>

    </div>

    <script>
        // --- CONFIGURATION ---
        const SUPABASE_URL = 'https://veebcognrjvianxcpnnh.supabase.co'; 
        const SUPABASE_KEY = 'sb_publishable_dmgqGdNwAVmN9YJKV6fikg_LOuUe2Ny'; 

        // --- VARIABLES ---
        let supabaseClient = null; 
        let gameMode = 'ai';
        let playerName = localStorage.getItem('rps_player_name') || '';
        let deviceId = localStorage.getItem('rps_device_id');
        let currentLobbyId = null;
        let myScore = 0;
        let opScore = 0;
        let channel = null; 
        let isHost = false;
        let myMove = null;
        let opMove = null;
        let isRoundProcessing = false;
        
        if (!deviceId) {
            deviceId = crypto.randomUUID();
            localStorage.setItem('rps_device_id', deviceId);
        }

        // Init Supabase
        if (SUPABASE_URL && SUPABASE_KEY) {
            if (typeof window.supabase !== 'undefined') {
                supabaseClient = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
            }
        } else {
            document.getElementById('setup-warning').classList.remove('hidden');
        }

        // --- NAVIGATION ---
        function hideAll() {
            const screens = ['menu-screen', 'name-screen', 'lobby-screen', 'waiting-screen', 'game-screen', 'winner-screen', 'leaderboard-screen', 'countdown-screen'];
            screens.forEach(id => {
                const el = document.getElementById(id);
                if (el) el.classList.add('hidden');
            });
        }

        function showMenu() {
            hideAll();
            cleanupGame();
            document.getElementById('menu-screen').classList.remove('hidden');
        }

        function showNameEntry() {
            if (!supabaseClient) return alert("Please configure Supabase Keys first!");
            hideAll();
            document.getElementById('name-screen').classList.remove('hidden');
            if (playerName) document.getElementById('player-name-input').value = playerName;
        }

        function startGameAI() {
            gameMode = 'ai';
            playerName = "Player";
            startMatch("CPU-9000");
        }

        // --- GAME LOGIC ---
        function startMatch(opponentName) {
            hideAll();
            myScore = 0;
            opScore = 0;
            updateScoreUI();
            
            document.getElementById('p1-name').innerText = gameMode === 'pvp' ? playerName : "PLAYER";
            document.getElementById('p2-name').innerText = opponentName;
            
            resetRoundUI();
            document.getElementById('game-screen').classList.remove('hidden');
        }

        function makeMove(move) {
            if (myMove || isRoundProcessing) return;

            myMove = move;
            
            // UI Feedback
            const display = document.getElementById('my-move-display');
            display.innerHTML = `<i class="${getIcon(move)}"></i>`;
            display.classList.add('punching-left');
            
            document.getElementById('status-text').innerText = "Waiting for Opponent...";

            if (gameMode === 'ai') {
                setTimeout(aiResponse, 800);
            } else {
                sendPvPMove(move);
            }
        }

        function aiResponse() {
            const moves = ['sten', 'sax', 'pase'];
            opMove = moves[Math.floor(Math.random() * moves.length)];
            resolveRound();
        }

        function resolveRound() {
            isRoundProcessing = true;
            
            // Opponent Visuals
            const opDisplay = document.getElementById('op-move-display');
            opDisplay.innerHTML = `<i class="${getIcon(opMove)}"></i>`;
            opDisplay.classList.add('punching-right');

            // Winner Logic
            let result = "";
            if (myMove === opMove) {
                result = "draw";
                showRoundResult("DRAW!", "text-yellow-400 bg-slate-900/90");
            } else if (
                (myMove === 'sten' && opMove === 'sax') ||
                (myMove === 'sax' && opMove === 'pase') ||
                (myMove === 'pase' && opMove === 'sten')
            ) {
                result = "win";
                myScore++;
                showRoundResult("POINT WON!", "text-emerald-400 bg-emerald-950/50");
            } else {
                result = "lose";
                opScore++;
                showRoundResult("POINT LOST!", "text-red-400 bg-red-950/50");
            }

            updateScoreUI();

            // Check game end
            if (myScore >= 10 || opScore >= 10) {
                setTimeout(() => endGame(myScore >= 10), 1500);
            } else {
                setTimeout(resetRound, 1500);
            }
        }

        function showRoundResult(text, styleClasses) {
            const msg = document.getElementById('result-message');
            msg.innerText = text;
            msg.className = `absolute -top-10 px-6 py-2 rounded-full text-xl font-black z-10 border border-slate-700 shadow-2xl transition-all ${styleClasses}`;
            msg.classList.remove('hidden');
        }

        function resetRound() {
            myMove = null;
            opMove = null;
            isRoundProcessing = false;
            resetRoundUI();
        }

        function resetRoundUI() {
            document.getElementById('my-move-display').innerHTML = '<i class="fas fa-fist-raised"></i>';
            document.getElementById('op-move-display').innerHTML = '<i class="fas fa-fist-raised"></i>';
            document.getElementById('my-move-display').classList.remove('punching-left');
            document.getElementById('op-move-display').classList.remove('punching-right');
            document.getElementById('status-text').innerText = "VÄLJ DITT DRAG";
            document.getElementById('result-message').classList.add('hidden');
        }

        function getIcon(move) {
            if (move === 'sten') return 'fas fa-hand-rock';
            if (move === 'sax') return 'fas fa-hand-scissors';
            return 'fas fa-hand-paper';
        }

        function updateScoreUI() {
            document.getElementById('p1-score').innerText = myScore;
            document.getElementById('p2-score').innerText = opScore;
        }

        async function endGame(won) {
            document.getElementById('winner-screen').classList.remove('hidden');
            document.getElementById('end-title').innerText = won ? "VICTORY!" : "DEFEAT!";
            document.getElementById('end-title').className = won 
                ? "text-5xl md:text-6xl text-emerald-400 retro-text text-center" 
                : "text-5xl md:text-6xl text-red-600 retro-text text-center";
            
            if (won && gameMode === 'pvp') {
                await saveWinToLeaderboard();
            }
            
            if (gameMode === 'pvp') cleanupGame();
        }

        // --- MULTIPLAYER ---

        async function enterLobbySystem() {
            const inputName = document.getElementById('player-name-input').value.trim();
            if (!inputName) return;
            
            playerName = inputName;
            localStorage.setItem('rps_player_name', playerName);
            
            hideAll();
            document.getElementById('lobby-screen').classList.remove('hidden');
            refreshLobbies();
        }

        async function refreshLobbies() {
            const list = document.getElementById('lobby-list');
            list.innerHTML = '<div class="flex items-center justify-center p-10"><i class="fas fa-spinner animate-spin mr-2"></i> Scanning...</div>';

            const { data, error } = await supabaseClient
                .from('lobbies')
                .select('*')
                .eq('status', 'waiting')
                .order('created_at', { ascending: false });

            if (error) {
                list.innerHTML = '<p class="text-red-400 text-center p-4">Error fetching rooms.</p>';
                return;
            }

            list.innerHTML = '';
            if (data.length === 0) {
                list.innerHTML = '<p class="text-slate-500 text-center mt-10">No rooms found. Create your own!</p>';
            }

            data.forEach(lobby => {
                const div = document.createElement('div');
                div.className = "flex justify-between items-center bg-slate-800 p-4 rounded-xl border border-slate-700 hover:border-blue-500 transition-colors";
                div.innerHTML = `
                    <div class="flex items-center gap-3">
                        <div class="w-2 h-2 rounded-full bg-emerald-500 animate-pulse"></div>
                        <span class="font-bold text-slate-200">${lobby.host_name}</span>
                    </div>
                    <button onclick="joinLobby('${lobby.id}', '${lobby.host_name}')" class="px-5 py-2 bg-blue-600 rounded-lg text-xs font-black hover:bg-blue-500 uppercase tracking-tighter">JOIN</button>
                `;
                list.appendChild(div);
            });
        }

        async function createLobby() {
            const { data, error } = await supabaseClient
                .from('lobbies')
                .insert([{ host_name: playerName, status: 'waiting' }])
                .select()
                .single();

            if (error) return;

            currentLobbyId = data.id;
            isHost = true;
            
            hideAll();
            document.getElementById('waiting-screen').classList.remove('hidden');
            document.getElementById('lobby-code-display').innerText = `ROOM ID: ${currentLobbyId.substring(0,8)}`;
            
            subscribeToLobby(currentLobbyId);
        }

        async function joinLobby(lobbyId, hostName) {
            const { error } = await supabaseClient
                .from('lobbies')
                .update({ player2_name: playerName, status: 'playing' })
                .eq('id', lobbyId);

            if (error) return alert("Failed to join room.");

            currentLobbyId = lobbyId;
            isHost = false;
            gameMode = 'pvp';
            
            subscribeToLobby(lobbyId);
            startCountdown(hostName); 
        }

        function subscribeToLobby(lobbyId) {
            channel = supabaseClient.channel(`game_${lobbyId}`);

            channel
                .on('postgres_changes', { event: 'UPDATE', schema: 'public', table: 'lobbies', filter: `id=eq.${lobbyId}` }, (payload) => {
                    const newRow = payload.new;
                    if (isHost && newRow.status === 'playing') {
                        gameMode = 'pvp';
                        startCountdown(newRow.player2_name);
                    }
                })
                .on('broadcast', { event: 'move' }, ({ payload }) => {
                    if (payload.player !== playerName) {
                        opMove = payload.move;
                        if (myMove) {
                            resolveRound();
                        } else {
                            document.getElementById('status-text').innerText = "Opponent Ready!";
                        }
                    }
                })
                .subscribe();
        }

        function startCountdown(opponentName) {
            hideAll();
            const countScreen = document.getElementById('countdown-screen');
            const countNum = document.getElementById('countdown-number');
            countScreen.classList.remove('hidden');
            
            let count = 5;
            countNum.innerText = count;
            
            const timer = setInterval(() => {
                count--;
                countNum.innerText = count;
                if (count <= 0) {
                    clearInterval(timer);
                    countScreen.classList.add('hidden');
                    startMatch(opponentName);
                }
            }, 1000);
        }

        async function sendPvPMove(move) {
            await channel.send({
                type: 'broadcast',
                event: 'move',
                payload: { player: playerName, move: move }
            });
            
            if (opMove) resolveRound();
        }

        async function leaveLobby() {
            if (currentLobbyId && isHost) {
                await supabaseClient.from('lobbies').delete().eq('id', currentLobbyId);
            }
            showMenu();
        }

        function cleanupGame() {
            if (channel) supabaseClient.removeChannel(channel);
            channel = null;
            currentLobbyId = null;
        }

        // --- LEADERBOARD ---

        async function saveWinToLeaderboard() {
            const { data: existing } = await supabaseClient
                .from('leaderboard')
                .select('wins')
                .eq('device_id', deviceId)
                .single();

            const currentWins = existing ? existing.wins : 0;

            await supabaseClient
                .from('leaderboard')
                .upsert({ 
                    device_id: deviceId, 
                    name: playerName, 
                    wins: currentWins + 1 
                });
        }

        async function showLeaderboard() {
            if (!supabaseClient) return;
            hideAll();
            document.getElementById('leaderboard-screen').classList.remove('hidden');
            
            const tbody = document.getElementById('leaderboard-body');
            tbody.innerHTML = '<tr><td colspan="3" class="text-center p-10 italic">Fetching Hall of Fame...</td></tr>';

            const { data, error } = await supabaseClient
                .from('leaderboard')
                .select('name, wins')
                .order('wins', { ascending: false })
                .limit(10);

            tbody.innerHTML = '';
            if (error || !data) return;

            data.forEach((row, index) => {
                const tr = document.createElement('tr');
                tr.className = "bg-slate-800/50 hover:bg-slate-800 transition-colors";
                tr.innerHTML = `
                    <td class="px-4 py-4 text-yellow-500 font-black">#${index + 1}</td>
                    <td class="px-4 py-4 text-slate-100 font-bold">${row.name}</td>
                    <td class="px-4 py-4 text-right font-mono text-emerald-400 font-bold">${row.wins} W</td>
                `;
                tbody.appendChild(tr);
            });
        }
    </script>
</body>
</html>
</div>

</body>
</html>
